* Hello, GTK

感觉会一点 GUI 开发挺有用，试试了解下 [[https://gtk.org/][GTK]] 开发，起码能写个最简单的计算器。

* 过程记录

** macOS 安装 GTK 3

macOS 上用 =brew install gtk+3= 安装 GTK 3，小心 =gtk+= formula 是 GTK 2。

** [[file:00-version.c]] 打印 GTK+ 版本号

用 =gtk_major_version= 宏能访问到编译所用的 GTK 版本.

** [[file:01-hello.c]] 显示窗口 GtkWindow

显示一个空白的窗口，没别的。

** [[file:02-label.c]] 标签 GtkLabel

显示一个标签。

** [[file:03-button.c]] 按钮 GtkButton

显示一个按钮，用户点击时打印一条消息。

** [[file:04-image.c]] 图片 GtkImage

显示一张图片。

** [[file:05-input.c]] 用户输入 GtkEntry

接收用户输入，用户按确定键，打印输入。

** [[file:06-layout.c]] 布局 GtkBox

单列布局，两个标签一个按钮竖着拍出一列，按钮高度不扩大。

** [[file:07-file-choose-dialog.c]] 文件选择器 GtkFileChooserNative

分别尝试 GTK 和 macOS 系统风格，前者有点儿小清新，当然首选系统风格的。

** [[file:08-progress-bar.c]] 进度条 GtkProgressBar

使用定时器更新进度条。

** [[file:09-separator.c]] 间隔线 GtkSeparator

在两个标签之间画一条间隔线。

** [[file:10-tooltip.c]] 提示符 GtkTooltip

3 种 tooltip

- 纯文本
- Pango Markup
- 自定义

** [[file:11-multiline-text.c]] 跨行文本框 GtkTextView

显示一个跨行文本框，用户可以编辑。

** [[file:12-http-request-sync.c]] 同步地 HTTP 请求

依赖 libsoup 「HTTP client/server library for GNOME」，需要单独安装： =brew install libsoup= 。

等待用户输入一个 URL，使用 =soup_session_send_message= 同步地发 HTTP 请求，显示结果。

** [[file:13-parse-json.c]] 读取 JSON (json-glib)

试了两种方法 [[https://developer.gnome.org/json-glib/1.2/JsonPath.html][JsonPath]] 和 [[https://developer.gnome.org/json-glib/1.2/JsonReader.html][JsonReader]] ，中文(UTF-8)有问题，不知道为什么。另外没想到 C 读取个 JSON 这么不容易。

** [[file:14-events.c]] 处理窗口缩放、拖拽移动事件

- 要处理窗口移动和缩放，响应 configure-event
- 要处理窗口拖拽，响应 button-press-event，用 gtk_window_begin_move_drag 移动窗口

* 参考资料

- [[https://developer.gnome.org/][GNOME Developer Center]] 主要就是 API Reference
- [[http://zetcode.com/tutorials/gtktutorial/][GTK+ programming tutorial]] 好像针对 GTK 2 而不是 GTK 3
