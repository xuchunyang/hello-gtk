* Hello, GTK

æ„Ÿè§‰ä¼šä¸€ç‚¹ GUI å¼€å‘æŒºæœ‰ç”¨ï¼Œè¯•è¯•äº†è§£ä¸‹ [[https://gtk.org/][GTK]] å¼€å‘ï¼Œèµ·ç èƒ½å†™ä¸ªæœ€ç®€å•çš„è®¡ç®—å™¨ã€‚

* è¿‡ç¨‹è®°å½•

** macOS å®‰è£… GTK 3

macOS ä¸Šç”¨ =brew install gtk+3= å®‰è£… GTK 3ï¼Œå°å¿ƒ =gtk+= formula æ˜¯ GTK 2ã€‚

** [[file:00-version.c]] æ‰“å° GTK+ ç‰ˆæœ¬å·

ç”¨ =gtk_major_version= å®èƒ½è®¿é—®åˆ°ç¼–è¯‘æ‰€ç”¨çš„ GTK ç‰ˆæœ¬.

** [[file:01-hello.c]] æ˜¾ç¤ºçª—å£ GtkWindow

æ˜¾ç¤ºä¸€ä¸ªç©ºç™½çš„çª—å£ï¼Œæ²¡åˆ«çš„ã€‚

** [[file:02-label.c]] æ ‡ç­¾ GtkLabel

æ˜¾ç¤ºä¸€ä¸ªæ ‡ç­¾ã€‚

** [[file:03-button.c]] æŒ‰é’® GtkButton

æ˜¾ç¤ºä¸€ä¸ªæŒ‰é’®ï¼Œç”¨æˆ·ç‚¹å‡»æ—¶æ‰“å°ä¸€æ¡æ¶ˆæ¯ã€‚

** [[file:04-image.c]] å›¾ç‰‡ GtkImage

æ˜¾ç¤ºä¸€å¼ å›¾ç‰‡ã€‚

** [[file:05-input.c]] ç”¨æˆ·è¾“å…¥ GtkEntry

æ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œç”¨æˆ·æŒ‰ç¡®å®šé”®ï¼Œæ‰“å°è¾“å…¥ã€‚

** [[file:06-layout.c]] å¸ƒå±€ GtkBox

å•åˆ—å¸ƒå±€ï¼Œä¸¤ä¸ªæ ‡ç­¾ä¸€ä¸ªæŒ‰é’®ç«–ç€æ‹å‡ºä¸€åˆ—ï¼ŒæŒ‰é’®é«˜åº¦ä¸æ‰©å¤§ã€‚

** [[file:07-file-choose-dialog.c]] æ–‡ä»¶é€‰æ‹©å™¨ GtkFileChooserNative

åˆ†åˆ«å°è¯• GTK å’Œ macOS ç³»ç»Ÿé£æ ¼ï¼Œå‰è€…æœ‰ç‚¹å„¿å°æ¸…æ–°ï¼Œå½“ç„¶é¦–é€‰ç³»ç»Ÿé£æ ¼çš„ã€‚

** [[file:08-progress-bar.c]] è¿›åº¦æ¡ GtkProgressBar

ä½¿ç”¨å®šæ—¶å™¨æ›´æ–°è¿›åº¦æ¡ã€‚

** [[file:09-separator.c]] é—´éš”çº¿ GtkSeparator

åœ¨ä¸¤ä¸ªæ ‡ç­¾ä¹‹é—´ç”»ä¸€æ¡é—´éš”çº¿ã€‚

** [[file:10-tooltip.c]] æç¤ºç¬¦ GtkTooltip

3 ç§ tooltip

- çº¯æ–‡æœ¬
- Pango Markup
- è‡ªå®šä¹‰

** [[file:11-multiline-text.c]] è·¨è¡Œæ–‡æœ¬æ¡† GtkTextView

æ˜¾ç¤ºä¸€ä¸ªè·¨è¡Œæ–‡æœ¬æ¡†ï¼Œç”¨æˆ·å¯ä»¥ç¼–è¾‘ã€‚

** [[file:12-http-request-sync.c]] åŒæ­¥åœ° HTTP è¯·æ±‚

ä¾èµ– libsoup ã€ŒHTTP client/server library for GNOMEã€ï¼Œéœ€è¦å•ç‹¬å®‰è£…ï¼š =brew install libsoup= ã€‚

ç­‰å¾…ç”¨æˆ·è¾“å…¥ä¸€ä¸ª URLï¼Œä½¿ç”¨ =soup_session_send_message= åŒæ­¥åœ°å‘ HTTP è¯·æ±‚ï¼Œæ˜¾ç¤ºç»“æœã€‚

** [[file:13-parse-json.c]] è¯»å– JSON (json-glib)

è¯•äº†ä¸¤ç§æ–¹æ³• [[https://developer.gnome.org/json-glib/1.2/JsonPath.html][JsonPath]] å’Œ [[https://developer.gnome.org/json-glib/1.2/JsonReader.html][JsonReader]] ï¼Œä¸­æ–‡(UTF-8)æœ‰é—®é¢˜ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚å¦å¤–æ²¡æƒ³åˆ° C è¯»å–ä¸ª JSON è¿™ä¹ˆä¸å®¹æ˜“ã€‚

** [[file:14-events.c]] å¤„ç†çª—å£ç¼©æ”¾ã€æ‹–æ‹½ç§»åŠ¨äº‹ä»¶

- è¦å¤„ç†çª—å£ç§»åŠ¨å’Œç¼©æ”¾ï¼Œå“åº” configure-event
- è¦å¤„ç†çª—å£æ‹–æ‹½ï¼Œå“åº” button-press-eventï¼Œç”¨ gtk_window_begin_move_drag ç§»åŠ¨çª—å£

** [[file:15-dialog.c]] å¯¹è¯æ¡†

å„ç§å¯¹è¯æ¡†ï¼š
- è‡ªå®šä¹‰
- æ¶ˆæ¯
- å…³äº
- é¢œè‰²é€‰æ‹©
- å­—ä½“é€‰æ‹©

** [[file:16-clipboard.c]] è¯»å†™å‰ªåˆ‡æ¿

- gtk_clipboard_wait_for_text è¯»å–
- gtk_clipboard_set_text å†™å…¥

** [[file:17-process.c]] å­è¿›ç¨‹

åŒæ­¥å’Œå¼‚æ­¥å­è¿›ç¨‹ï¼Œå¼‚æ­¥å­è¿›ç¨‹çš„ IO ä¸ä¼šç”¨ã€‚

** [[file:18-gio-readfile.c]] GIO è¯»å–æ–‡ä»¶

1. g_file_new_for_path åˆ›å»º GFile
2. g_file_read åˆ›å»º GFileInputStream
3. g_input_stream_read è¯»å– stream

** [[file:19-frame.c]] è£…é¥°æ€§è¾¹æ¡† GtkFrame

é˜´å½±åŸºæœ¬çœ‹ä¸å‡ºæ•ˆæœæ¥ï¼Œèµ·ç  macOS æ˜¯å¦‚æ­¤ï¼Œæ˜¯ä¸æ˜¯ GTK ä¸»é¢˜è·Ÿ macOS ä¸åè°ƒï¼Ÿ

** [[file:20-status-bar.c]] çŠ¶æ€æ  GtkStatusbar

ç”¨ gtk_statusbar_push æ›´æ–°çŠ¶æ€æ ä¿¡æ¯ã€‚

** [[file:21-gtk-grid.c]] ç½‘æ ¼å¸ƒå±€ GtkGrid

ä½¿ç”¨ gtk_grid_attach æ·»åŠ å…ƒç´ ã€‚

** [[file:22-list-view.c]] åˆ—è¡¨æ§ä»¶ GtkTreeWidget

GtkTreeWidget é‡‡ç”¨ Model/View/Control

- GtkListStore æ˜¯ Modelï¼Œå¾€é‡Œé¢æ·»åŠ æ•°æ®ï¼Œç”¨åˆ° GtkTreeIter gtk_list_store_append gtk_list_store_set
- GtkWidget æ˜¯ Viewï¼Œæ·»åŠ æ ç”¨ GtkTreeViewColumnï¼Œå•å…ƒæ ¼æ˜¾ç¤ºç”¨ GtkCellRenderer æ§åˆ¶
- ç”¨ GtkTreeSelection å“åº”ç”¨æˆ·é€‰æ‹©

** [[file:23-search-entry.c]] æœç´¢æ§ä»¶ GtkSearchEntry

ä¿®æ”¹ä¹‹å 150 æ¯«ç§’ GtkSearchEntry ä¼šå‘å‡º search-changed ä¿¡å·ã€‚

** [[file:24-tree-view.c]] å¸¦å±‚çº§çš„åˆ—è¡¨æ§ä»¶ GtkTreeView

ç”¨ gtk_tree_store_set æ’å…¥åˆ—ï¼Œä¸åŒ GtkTreeIter è¡¨ç¤ºå±‚çº§ã€‚

** [[file:25-cairo.c]] ç”»å›¾ GtkDrawingArea

GtkDrawingArea æ˜¯ç”»å›¾æ§ä»¶ï¼Œå“åº”å®ƒå‘å‡ºçš„ draw ä¿¡å·ï¼Œç„¶åç”¨å®ƒä¼ é€’è¿‡æ¥çš„ cairo_t ä½œå›¾ã€‚

** [[file:26-gtk-grid-2.c]] ç½‘æ ¼å¸ƒå±€ GtkGrid

ç”¨ gtk_grid_attach æ·»åŠ å…ƒç´ ï¼Œå‚æ•°

1. `GtkGrid * grid`
2. `GtkWidget * child` è¦åŠ çš„å…ƒç´ 
3. `gint left` X åæ ‡, ä»é›¶å¼€å§‹è®¡æ•°
4. `gint top` Y åæ ‡ï¼Œä»é›¶å¼€å§‹è®¡æ•°
5. `gint width` å å‡ åˆ—
6. `gint height` å å‡ è¡Œ

å¤åˆ¶ https://python-gtk-3-tutorial.readthedocs.io/en/latest/layout.html#grid çš„æ•ˆæœã€‚

** [[file:27-list-box.c]] åˆ—è¡¨å®¹å™¨ GtkListBox

GtkListBox æ˜¯ä¸ªå‚ç›´çš„åˆ—è¡¨æ§ä»¶ï¼Œå…ƒç´ å¯ä»¥é€‰ä¸­ã€æ’åºã€è¿‡æ»¤ï¼Œç›¸æ¯”ä¹‹ä¸‹ GtkTreeWidget æ›´åŠ ä¸€èˆ¬åŒ–ã€‚

** [[file:28-popover.c]] å¼¹å‡ºèœå• GtkPopover

GtkTooltip é¼ æ ‡æ‚¬åœè‡ªåŠ¨å¼¹å‡ºçª—å£ï¼ŒGtkPopover éœ€è¦ç”¨æˆ·ç‚¹å‡»ï¼ŒGtkPopover æ˜¯ä¸ªå®¹å™¨ï¼Œæ·»åŠ ä»€ä¹ˆå…ƒç´ å°±æ˜¾ç¤ºä»€ä¹ˆï¼Œéœ€è¦è°ƒç”¨ gtk_widget_show å’Œ gtk_popover_popup æ˜¾ç¤ºã€‚

** [[file:29-stack.c]] æ¢é¡µæ§ä»¶ GtkStack

GtkStack æ˜¯ä¸ªå®¹å™¨ï¼ŒæŠŠæ˜¾ç¤ºçš„ä¹Ÿé¡µé¢åŠ å…¥å…¶ä¸­ï¼Œå†ç”¨ GtkStackSwitcher å¾—åˆ°ä¸€ä¸ªæ¢é¡µ Tab barã€‚

** [[file:30-headerbar.c]] å®šåˆ¶æ ‡é¢˜æ 

ç”¨ GtkHeaderBar æ›¿æ¢è‡ªå¸¦æ ‡é¢˜æ ã€‚

** [[file:31-flowbox.c]] GtkFlowBox æ°´å¹³æˆ–å‚ç›´è‡ªé€‚åº”

æ¯”å¦‚ä¸€è¡Œæ”¾ 100 ä¸ªæŒ‰é’®ï¼Œæ˜¾ç„¶æ”¾ä¸ä¸‹ï¼Œç”¨ GtkFlowBox ä¹‹åç©ºé—´ä¸å¤Ÿæ—¶è‡ªåŠ¨æ¢è¡Œã€‚

æ³¨æ„å¦‚æœå†…å®¹å¤šï¼Œçª—å£æ€ä¹ˆä¹Ÿæ”¾ä¸ä¸‹ï¼Œåº”è¯¥ç”¨ GtkScrolledWindow åŒ…è£¹èµ·æ¥ï¼Œæ¯”å¦‚çª—å£è¿‡å¤§ã€‚

** [[file:32-notebook.c]] æ ‡ç­¾é¡µ GtkNotebook

GtkNotebook æ˜¯ä¸ªå®¹å™¨ï¼Œåƒä¹¦ä¸€æ ·ï¼Œå¾€é‡Œé¢æ·»åŠ é¡µï¼Œæ¯æ¬¡åªæ˜¾ç¤ºå…¶ä¸­ä¸€é¡µã€‚æ›´æµè§ˆå™¨ Tab é¡µä¸€ä¸ªæ„æ€ã€‚

** [[file:33-spinner.c]] åŠ è½½åŠ¨ç”» GtkSpinner

GtkSpinner æ§ä»¶åˆ†åˆ«ç”¨ gtk_spinner_start/stop æ§åˆ¶å¼€å…³ã€‚

** [[file:34-glib-the-easy-parts.c]] GLib ç®€å•éƒ¨åˆ†

è¯•ç”¨ GLib å®¹æ˜“ç†è§£å’Œä½¿ç”¨çš„ APIã€‚

** [[file:35-glib-the-data-types.c]] GLib æ•°æ®ç»“æ„

- GString åŠ¨æ€å­—ç¬¦ä¸²
- GArray åŠ¨æ€æ•°ç»„ï¼Œä½†å…ƒç´ ç±»å‹ï¼ˆå¤§å°ï¼‰å¿…é¡»ä¸€è‡´
- GHashTable å“ˆå¸Œè¡¨ï¼Œé”®å¿…é¡»å¯æ¯”è¾ƒï¼ˆå³èƒ½åˆ¤æ–­ä¸¤ä¸ªæ˜¯å¦ç›¸åŒï¼Œæ‰€ä»¥é”®ç±»å‹åº”è¯¥ä¸€æ ·ï¼Ÿï¼‰ï¼Œå€¼æ— æ‰€è°“
- GList åŠ¨æ€åˆ—è¡¨ï¼Œå…ƒç´ æ˜¯æŒ‡é’ˆ
- GQueue é˜Ÿåˆ—
- GTree ğŸŒ²

** [[file:36-gtk-css.c]] GtkCssProvider ç”¨ CSS å®šåˆ¶ GTK

ç”¨ gtk_widget_set_name æ·»åŠ  IDï¼Œç»™ CSS å½“é€‰æ‹©å™¨ã€‚

ç”¨ =GTK_DEBUG=interactive ./36-gtk-css= è°ƒå‡ºäº¤äº’ Debuggerï¼Œå¯ä»¥å®æ—¶æ”¹å˜ CSSã€‚

** [[file:37-pango.c]] Pango æ–‡å­—æ’ç‰ˆ

ç”¨ PangoLayout å­˜å‚¨æ–‡å­—å†…å®¹ï¼Œç”¨ PangoFontDescription è®¾ç½®å­—ä½“ï¼Œç”¨ pango_cairo_show_layout æ˜¾ç¤ºã€‚

ç”¨ Pango å¯ä»¥ä¸­æ–‡ç«–æ’ï¼Œè§ https://pango.gnome.org/ScriptGallery æˆªå›¾ï¼Œç›®å‰è¿˜ä¸æ¸…æ¥šä»£ç æ€ä¹ˆå¼„ã€‚

** [[file:38-gio-http-req.c]] HTTP request with GIO

ç›®çš„æ˜¯å®ç° =curl example.com= ã€‚

ç”¨ g_socket_client_connect_to_host å»ºç«‹è¿æ¥ï¼Œç„¶åé€šè¿‡ GOutputStream å’Œ GInputStream è¾“å…¥è¾“å‡ºã€‚æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ä¸çŸ¥é“æœåŠ¡å™¨çš„è¾“å‡ºç»“æŸäº†æ²¡ï¼Œæˆ‘ä»¥ä¸ºè¯¥æŠ¥ EOF å´æ²¡æŠ¥ã€‚

** [[file:39-gtksourceview.c]] GtkSourceView ç¼–è¾‘å™¨åº“

å®‰è£… =brew install gtksourceview4= ã€‚

GtkSourceView æ˜¯ GtkTextView çš„æ‰©å±•ï¼ˆå­ç±»ï¼‰ï¼Œåˆ†åˆ«ç”¨ GtkSourceView å’Œ GtkSourceBuffer æ§åˆ¶æ˜¾ç¤ºå’Œå†…å®¹ã€‚

** [[file:40-gspell.c]] æ‹¼å†™æ£€æŸ¥

å®‰è£… =brew install gspell= ã€‚

å¯ä»¥ç»™ GtkEntry å’Œ GtkTextView åŠ ä¸Šæ‹¼å†™æ£€æŸ¥ã€‚

** [[file:41-terminal.c]] ç»ˆç«¯åº”ç”¨ VTE

å®‰è£… =brew install vte3= ã€‚

VteTerminal æ˜¯ä¸ª GTK æ§ä»¶ï¼Œç”¨ vte_terminal_spawn_async å¯åŠ¨ shellã€‚

* å‚è€ƒèµ„æ–™

- [[https://developer.gnome.org/][GNOME Developer Center]] ä¸»è¦å°±æ˜¯ API Reference
- [[http://zetcode.com/tutorials/gtktutorial/][GTK+ programming tutorial]] æ³¨æ„é’ˆå¯¹ GTK 2 è€Œä¸æ˜¯ GTK 3
- [[https://valadoc.org/][Valadoc.org â€“ Stays crunchy. Even in milk.]] æœç´¢ API æ–‡æ¡£
- [[https://python-gtk-3-tutorial.readthedocs.io/en/latest/][The Python GTK+ 3 Tutorial â€” Python GTK+ 3 Tutorial 3.4 documentation]] æ¯”è¾ƒæ–°
